—Ä–æ–∑—ñ–±—Ä–∞—Ç–∏—Å—è: –∑ –ø–æ–º–∏–ª–∫–∞–º–∏, http-errors !!!!!; Mongoose; MongoDB; Promise.all and other
–ø–æ–¥–∏–≤–∏—Ç–∏—Å—è –ø—Ä–æ –∞–¥–∞–ø—Ç–µ—Ä

<!-- 6 module - hw6-email-and-images -->

    <!-- 6 module - hw6-email-and-images -->

üü° brevo.com - —Å–µ—Ä–≤—ñ—Å –¥–ª—è –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –ø–æ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ñ–π –ø–æ—à—Ç—ñ.
üü† –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ **nodemailer** - —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –ª–∏—Å—Ç—ñ–≤.
npm install nodemailer
üü† –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–æ–±–æ—Ç–∏ —ñ–∑ JWT - jsonwebtoken (npm i jsonwebtoken)
üü† **handlebars** –®–∞–±–ª–æ–Ω—ñ–∑–∞—Ç–æ—Ä –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ª–∏—Å—Ç—ñ–≤ https://handlebarsjs.com/
npm i handlebars

1. –ù–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ env.js, env, env.example
2. –°–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—é:

   - ‚úÖ services/auth:
     - path (—à–ª—è—Ö –¥–æ —à–∞–±–ª–æ–Ω—É –ª–∏—Å—Ç–∞)
     - —á–∏ —î —é–∑–µ—Ä - —è–∫—â–æ —Ç–∞–∫, —Å—Ç–≤–æ—Ä–∏–ª–∏ —Ç–æ–∫–µ–Ω —Å–∫–∏–¥—É –ø–∞—Ä–æ–ª—è(–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–ª–∏ JWT_SECRET), —Å—Ç–≤–æ—Ä–∏–ª–∏ –ª–∏—Å—Ç —à–∞–±–ª–æ–Ω (–≤—ñ–¥ –∫–æ–≥–æ, Link —è–∫–∏–π –ø–µ—Ä–µ–≤–µ–¥–∞ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É FRONTEND_DOMAIN, –¥–µ –∑–∫–æ–ø—ñ—é—î–º–æ —Ç–æ–∫–µ–Ω –¥–ª—è –∑–º—ñ–Ω–∏ –ø–∞—Ä–æ–ª—è) –≤—ñ–¥–ø—Ä–∞–≤–∏–ª–∏ –ª–∏—Å—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É –Ω–∞ —ñ–º–µ–π–ª(–∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é brevo.com)
   - ‚úÖ utils/sendEmail.js - –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –ª–∏—Å—Ç—ñ–≤(–∫–æ–º—É, –≤—ñ–¥ –∫–æ–≥–æ, —Å–∞–º –ª–∏—Å—Ç)
   - ‚úÖ controllers/auth (–ø–µ—Ä–µ–¥–∞–ª–∏ —É —Ñ—É–Ω–∫ req.body, –æ—Ç—Ä–∏–º–∞–ª–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å res.json({}));
   - ‚úÖ Shema (validation/requestResetEmailSchema) - email ;
   - ‚úÖ routers/auth

3. –ó–∞–º—ñ–Ω–∞ –ø–æ—Ä–æ–ª—é –Ω–∞ –Ω–æ–≤–∏–π:

   - services/auth
   - controllers/auth
   - Shema (validation/) - password, email
   - routers/auth

   ---== üèûÔ∏è üèûÔ∏è üèûÔ∏è üèûÔ∏è üèûÔ∏è üèûÔ∏è üèûÔ∏è üèûÔ∏è ==---

4. –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è: multer(–æ–±—Ä–æ–±–∫–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤), –∑–∞–≤–∞–Ω—Ç–∞–∂. –Ω–∞ —Å–≤—ñ–π —Å–µ—Ä–≤–µ—Ä —Ç–∞ cloudinary, feature flag.

   - multer –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤(–∑–æ–±—Ä–∞–∂–µ–Ω—å) (–¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏: destination (–≤ —è–∫—É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –±—É–¥—É—Ç—å –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ —Ñ–∞–π–ª–∏) —ñ filename).
     üü† npm i multer
   - –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ form-data –≤ postman. –ó–º—ñ–Ω—é—î–º–æ –ø–∞—Ä—Å–∏–Ω–≥ –¥–ª—è form-data. —Å—Ç–≤–æ—Ä—é—î–º–æ midlewar - multer.js, –ø–æ–∫–ª–∞–¥–µ–º–æ –π–æ–≥–æ –≤ route/PATCH - upload.single('photo'),

? –ü—Ä–∏—Ö–æ–¥–∏—Ç—å –∑–∞–ø–∏—Ç - –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ —Ç–∏–º—á–∞—Å–æ–≤—ñ–π –ø–∞–ø—Ü—ñ temp - –ø–æ—Ç—ñ–º –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –∞–±–æ –ª–æ–∫–∞–ª—å–Ω–æ –∞–±–æ –Ω–∞ —Ö–º–∞—Ä—ñ

- —Å—Ç–≤–æ—Ä—é—î–º–æ –ø–∞–ø–∫—É –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ –∫–∞—Ä—Ç–∏–Ω–æ–∫
- ‚úÖ –ü—Ä–∏ –∑–∞–ø—É—Å–∫—É –¥–æ–¥–∞—Ç–∫—É –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —î —É –Ω–∞—Å –ø–µ–≤–Ω–∞ –ø–∞–ø–∫–∞, —ñ —è–∫—â–æ –Ω–µ–º–∞—î —Ç–æ —Å—Ç–≤–æ—Ä—é—î–º–æ —ó—ó:
  –°—Ç–≤–æ—Ä—é—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é –≤ utils createDirIfNotExist. –≤—Å—Ç–∞–≤–ª—è—î–º–æ —Ü—é —Ñ—É–Ω–∫—Ü—ñ—é –≤ src/index –ø–µ—Ä–µ–¥ await initMongoConnection(); - –ø–∞–ø–∫–∞ src/temp - –ø–∞–ø–∫–∞ src/uploads
  –ê–ë–û ‚ùé (—Ç–∞–∫ –∫—Ä–∞—â–µ) - —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–∞–ø–∫—É —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –∑ —Ñ–∞–π–ª–æ–º .gitkeep - —Ñ–∞–π–ª-'–ø—É—Å—Ç–∏—à–∫–∞';
- path –¥–æ: src/temp, src/uploads

- —è–∫—â–æ —Ñ–æ—Ç–æ –ø—Ä–∏–π—à–ª–æ —Ç–æ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –π–æ–≥–æ —É –ø–æ—Å—Ç—ñ–π–Ω–µ —Å—Ö–æ–≤–∏—â–µ
  controller, services
- –æ–Ω–æ–≤–∏—Ç–∏ contactSchema

- —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ - –æ–∫—Ä–µ–º–æ –≤ utils:
  - saveFileToLocal.js
  - saveFileToCloudinary.js
- üü¢ —â–æ–± —Ñ–æ—Ç–æ –±—É–ª–æ –¥–æ—Å—Ç—É–ø–Ω–µ –Ω–µ —Ç—ñ–ª—å–∫–∏ –Ω–∞ –Ω–∞—à–æ–º—É –∫–æ–º–ø, –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ —Ö–º–∞—Ä–Ω–æ–º—É —Å—Ö–æ–≤–∏—â—ñ (–Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ):
  srs/server - app.use('/uploads', express.static(UPLOADS_DIR_PATH));

  - src/server:

- CLOUDINARY
  - npm install cloudinary
  - utils/saveFileToCloudinary
- —Ñ–∞–π–ª–∏ –≤ gitIgnore. –°–ø–æ—á–∞—Ç–∫—É –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏ gitkeep, –ø–æ—Ç—ñ–º –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏ –≤ gitIgnore:
  /temp/**
  /uploads/**

  –•—ñ–¥ —Ä–æ–±–æ—Ç–∏:

- —Å—Ç–≤–æ—Ä–∏–ª–∏ midlewar - multer (–æ–±—Ä–æ–±–∫–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤(—Ñ–æ—Ç–æ) –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –∫—É–¥–∏ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏, —è–∫–∞ –Ω–∞–∑–≤–∞ –ø—Ä–∏ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω–∏);
- —Å—Ç–≤–æ—Ä–∏–ª–∏ —à–ª—è—Ö–∏ temp(–∑–±–µ—Ä—ñ–≥–∏–Ω–Ω—è —Ç–∏–º—á–∞—Å–æ–≤–æ), uploads(–∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ø–æ—Å—Ç—ñ–π–Ω–µ), (–∞–±–æ –≤—Ä—É—á–Ω—É + .gitkeep, –∞–±–æ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—é –≤ utils createDirIfNotExist. —è–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î —á–∏ —ñ—Å–Ω—É—î —Ñ–∞–π–ª, —è–∫ –Ω—ñ —Ç–æ —Å—Ç–≤–æ—Ä—é—î –π–æ–≥–æ);
- –≤ postman –ø—Ä–∞—Ü—é—î–º–æ —á–µ—Ä–µ–∑ form-data;

üòé FICHA FLAG ‚Üì

- –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –∑–º—ñ–Ω–Ω–æ—ó –æ—Ç–æ—á–µ–Ω–Ω—è, –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –ª–æ–∫–∞–ª—å–Ω–æ —á–∏ –Ω–∞ CLOUDINARY.
  —Å—Ç–≤–æ—Ä—é—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é –≤ utils saveFile.js

–ú–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –æ–±–≥–æ—Ä—Ç–∫—É, –¥–µ "http://localhost:3000/uploads/ –≤–∂–µ –±—É–¥–µ, –∞ –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –Ω–∞–∑–≤–∞ —Ñ–∞–π–ª—É. –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –º–æ–∂–Ω–∞ –≤ utils/serializeUser
–ß–∏ —É–≤—ñ–º–∫–Ω–µ–Ω–∏–π —Ñ—ñ—á–∞-—Ñ–ª–∞–≥, –£ –≤–∏–ø–∞–¥–∫—É cloudinary –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –ø–æ–≤–Ω–∏–π —à–ª—è—Ö, –∞ —É –≤–∏–ø–∞–¥–∫—É –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ - —á–∞—Å—Ç–∫–æ–≤–∏–π —à–ª—è—Ö

<!-- 5 module - hw4-validation -->

          <!-- 5 module - hw5-authenticate -->
          –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è, –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î REST, –∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–µ—Ç–æ–¥–∏ post

1.  A—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó (–Ω–∞ –æ—Å–Ω–æ–≤—ñ –ª–æ–≥—ñ–Ω—É, –ø–∞—Ä–æ–ª—é) - –≤—Ö—ñ–¥ –≤ —Å–∏—Å—Ç–µ–º—É

    –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ –∑–∞–ø–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ö–µ–¥–µ—Ä–∞ Authorization Bear <token>

    1.1. auth-user
    **–†–µ—ó—Å—Ç—Ä–∞—Ü—ñ—è:**

        - —Å—Ç–≤–æ—Ä—é—î–º–æ —Å—É—Ç–Ω—ñ—Å—Ç—å user (models/user.js)
        - validation (validation/user.js)
        - —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è user (services/auth.js)
        - controllers/auth - –¥–ª—è register
        - —à–ª—è—Ö auth (routes/auth.js) - authRouter
        - routers/index.js (–ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å—é–¥–∏ —Ä–æ—É—Ç–∏ contacts —ñ auth),
          —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —à–ª—è—Ö–∏ —É routes/contacts, –æ–Ω–æ–≤–∏—Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ä–æ—É—Ç—ñ–≤ –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ routes/index.js
        - validation/registerUser.js
        - –æ–±—Ä–æ–±–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏ (middlewar/errorHandler)
          1.2. - –∫–µ—à—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—é **npm i bcrypt** - –ø—Ä–∏–±—Ä–∞—Ç–∏ –ø–æ–ª–µ –∑ –ø–∞—Ä–æ–ª–µ–º –ø—Ä–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
          //
          userSchema.methods.toJSON = function () {
          const obj = this.toObject();
          delete obj.password;
          return obj;
          };
          //–∞–±–æ –æ–±–≥–æ—Ä—Ç–∫–∞ —â–æ –≤—ñ–¥–¥–∞—î–º–æ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
          —Å—Ç–≤–æ—Ä–∏—Ç–∏—Ç utils/serializeUser.js, –æ–±–≥–æ—Ä—Ç–∞—î–º–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ—é —Ñ—É–Ω–∫—Ü—ñ—î—é user –≤ controllers/user

2.  **Login**

    - services/auth - router/auth;
    - controller/auth;
    - —Å—Ö–µ–º–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó (validation/login);
    - routers/auth;

3.  **session** –≤ login-user

    - models/session.js;
    - —É —Ñ–∞–π–ª –∫–æ–Ω—Å—Ç–∞–Ω—Ç –Ω–æ–≤—ñ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏
    - services/auth.js

4.  cookies **npm i cookie-parser**
    –º–µ—Ç–æ–¥ .cookie

    - server.js;
    - controllers/auth.js (login)

5.  **logout**
    —Ç—Ä–µ–±–∞ –æ—á–∏—Å—Ç–∏—Ç–∏ cookies (–ª–∏—à–µ —Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ —Ü–µ –∑—Ä–æ–±–∏—Ç–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ httpOnly), –∞ —Ç–∞–∫–æ–∂ –≤–∏–¥–∞–ª–∏—Ç–∏ —Å–µ—Å—ñ—é —ñ–∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:

    - services/auth.js;
    - controllers/auth.js
      res.clearCookie - –æ—á–∏—â–∞—î –∫—É–∫—ñ
    - routers/auth.js;

6.  **refresh**
    —Å—Ç–∞—Ä—É —Å–µ—Å—ñ—é –≤–∏–¥–∞–ª–∏—Ç–∏, –Ω–æ–≤—É —Å—Ç–≤–æ—Ä–∏—Ç–∏, —è–∫—â–æ —Ç–æ–∫–µ–Ω –≤–∂–µ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–∏–π —Ç–æ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ –ª–æ–≥—ñ–Ω—ñ–∑–∞—Ü—ñ—é
    - controller
    - router
7.  –ø—Ä–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—ñ **accessToken**, –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –¥–æ—Å—Ç—É–ø–∏ –≤ midlewar

                - (authenticate.js) - routers/contact (contactsRouter.use('/', authentificate)) - —è–∫—â–æ user –Ω–µ –∑–∞–ª–æ–≥—ñ–Ω–µ–Ω–∏–π —Ç–æ –ø—Ä–∏ get –∑–∞–ø–∏—Ç—ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏ –Ω–µ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—Ç—å—Å—è.
                - Postman: auth/login (–±–µ—Ä–µ–º–æ —Ç–æ–∫–µ–Ω) - contact/get_all (–≤ —Ö–µ–¥–µ—Ä Bearer '–≤—Å—Ç–∞–≤–ª—è–µ–º–æ —Ç–æ–∫–µ–Ω' ) = –æ—Ç—Ä–∏–º—É—î–º–æ –∫–æ–Ω—Ç–∞–∫—Ç–∏;
                  Authorization - Bearer 'token'(—Ç–æ–π —â–æ –ø—Ä–∏ auth/login) (postman/header –Ω–∞ get –∑–∞–ø–∏—Ç—ñ)

            \*. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω—É –≤ get –∑–∞–ø–∏—Ç –≤ postman: login/Scripts:

        //
        const jsonData = pm.response.json();
        pm.environment.set('access_token', jsonData.data.accessToken)
        //
        Environment, Local - Variable: access_token;
        Colections/getContact/Auth - AuthType (BearerToken), Token ({{access_token}})

8.  Authorization
    –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–≥–ª–∏ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –ª–∏—à–µ –∑ –≤–ª–∞—Å–Ω–∏–º–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏;
    –º–µ—Ç–æ–¥–∏ Mongoose —Ç–∞–∫—ñ —è–∫ find(), findOne() —Ç–æ—â–æ.

        - models/contact Schema –¥–æ–¥–∞—Ç–∏ –ø–æ–ª–µ userId;
        - controllers/contact –¥–æ–¥–∞—Ç–∏ userId;
        - services/contact –≤ contactQuery –¥–æ–¥–∞—Ç–∏ –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∏ userId
        - –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç—É —Ç–∞–∫–æ–∂ –¥–æ–¥–∞–≤–∞–ª–æ—Å—è –ø–æ–ª–µ userId
        - services/contacts.js –¥–æ–¥–∞–π—Ç–µ –ø–æ—à—É–∫:
            const contactsQuery = ContactsCollection.find({ userId });
        - userId –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤ —Å–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ñ getContactsController

    <!-- 4 module - hw4-validation -->

                   <!-- 4 module - hw4-validation -->

9.  Validation:
    npm i joi

    - —Å—Ö–µ–º–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ joi () - —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è/–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—É
      // src/validation/contact.js

    - Middleware - –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–ª—è —Ä–æ—É—Ç—ñ–≤
      // src/middlewares/validateBody.js

      - validateBody(—Å—Ö–µ–º–∞) - –ø–æ–≤–µ—Ä—Ç–∞—î middleware –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó body –∑–∞–ø–∏—Ç—É;
      - isValidId - –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ —ó—ó –≤ —É—Å—ñ—Ö —Ä–æ—É—Ç–∞—Ö, —è–∫—ñ –ø—Ä–∞—Ü—é—é—Ç—å –∑ id —Å—Ç—É–¥–µ–Ω—Ç–∞

    - –¥–æ–¥–∞—Ç–∏ —É —Ä–æ—É—Ç–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—é
      // src/routers/students.js

10. –ü–∞–≥—ñ–Ω–∞—Ü—ñ—è:
    2.1. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è:

         - –ª–æ–≥—ñ–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥—É –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –ø–æ—à—É–∫—É (page - —Å—Ç–æ—Ä—ñ–Ω–∫–∞, perPage - —Å–∫—ñ–ª—å–∫–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ)
           // src/utils/parsePaginationParams.js
         - page, perPage –¥–æ–¥–∞—Ç–∏ –≤ getStudentsController
           // src/controllers/students.js
         - calculatePaginationData - –ø–æ–≤–µ—Ä—Ç–∞—î –æ–±'—î–∫—Ç –∑ –ø–æ–≤–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—é
           // src/utils/calculatePaginationData.js
         - –¥–æ–¥–∞—Ç–∏ –¥–æ —Å–µ—Ä–≤—ñ—Å—É –ª–æ–≥—ñ–∫—É –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–ø–∏—Ç—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
           // src/.../services/students.js

    - .limit() - —Å–∫—ñ–ª—å–∫–∏ —Ö–æ—á–µ–º–æ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏;
    - .skip() - —Å–∫—ñ–ª—å–∫–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏/–≤—ñ–¥—Å—Ç—É–ø–∏—Ç–∏

11. –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è: sortBy - –ø–æ —á–æ–º—É, sortOrder - –ø–æ—Ä—è–¥–æ–∫ (ascendants)‚Üë, (descendants)‚Üì
    - .sort()
12. –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è
    –∑ —Ñ—ñ–ª—å—Ç—Ä–∞–º–∏ –±—É–¥–µ –±–∞–∑–æ–≤–∏–π query
    —Ñ—ñ–ª—å—Ç—Ä –≤–ø–ª–∏–≤–∞—î –Ω–∞ –∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤
    gte - –±—ñ–ª—å—à–µ/–¥–æ—Ä—ñ–≤–Ω—é—î
    lte - –º–µ–Ω—à–µ
    equals - –¥–ª—è —Å—Ç—Ä–æ–∫–∏, –±—É–ª—è

- merge -

5.  !!! –≥–ª–æ–±–∞–ª—å–Ω–∏–π –∫–ª–∞—Å **Promise** - –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç–∏ –¥–≤–∞ –ø—Ä–æ–º—ñ—Å–∞

- Promise.all
- Promise.allset

<!-- 3 module - hw3-crud -->

1.  —Å—Ç–≤–æ—Ä—é—î–º–æ folder:

    - routers(/contacts.js); router.get()
    - controllers(/contacts.js); res.status(200)
    - middlewares(errorHandler.js , notFoundHandler.js);

2.  –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤—É—î–º–æ —Ä–æ—É—Ç—ñ–Ω–≥:

        - –∫–æ–¥ —Ä–æ—É—Ç—ñ–≤ –∑ src/server.js –¥–æ —Ñ–∞–π–ª—É src/routers/contacts.js;
        - –∫–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ–≤ –∑ src/routers –¥–æ —Ñ–∞–π–ª—É src/controllers/contacts.js;

3.  –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫ ( http-errors ): npm install http-errors:
    - src/controllers/students.js;
    - src/middlewares/errorHandler.js - –¥–æ–¥–∞—î–º–æ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –ø–æ–º–∏–ª–∫–∞–º–∏;
4.  –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫ –≤ middleware:

        - errorHandler.js //status(500)
        - notFoundHandler.js //status(404)
        - —ñ–º–ø–æ—Ä—Ç—É—î–º–æ –≤ server

5.  **???? ctrlWrapper.js**

    <!--  -->
    <!-- –ó–∞–ø–∏—Ç–∏, POST, PUT, PATCH, DELETE -->

    **controllers - routers - services**

6.  POST
    //–º–µ—Ç–æ–¥: Model.create(doc) –î–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
7.  PATCH
    //–º–µ—Ç–æ–¥: Model.findOneAndUpdate(query, update, options, callback) –î–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ –∫–æ–ª–µ–∫—Ü—ñ—ó
8.  DELETE
    //–º–µ—Ç–æ–¥: Model.findOneAndDelete(filter, options, callback)

<!-- 2 module - hw2-mongodb-->

// node --version
// node src/index.js

–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:

1. **npm init -y** //—ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –ø—Ä–æ–µ–∫—Ç;
2. –≤ package.json: "type": "module",
3. **eslint** //–õ—ñ–Ω—Ç—ñ–Ω–≥ –∫–æ–¥—É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É:
   npm init @eslint/config@latest;
4. **.editorconfig** //–ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ —Å—Ç–∏–ª—ñ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –∫–æ–¥—É –≤ —Ä—ñ–∑–Ω–∏—Ö —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞—Ö —ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö;
5. **.gitignore**;
6. **.prettierrc**;
7. **?????** eslint.config.mjs (.js/.cjs) –ß–ò –ó–ú–Ü–ù–Æ–í–ê–¢–ò –Ø–ö –£ –ö–û–ù–°–ü–ï–ö–¢–Ü;
8. **nodemon** —è–∫ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å:
   npm install --save-dev nodemon //–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—î —Å–µ—Ä–≤–µ—Ä –ø—ñ—Å–ª—è –∑–º—ñ–Ω;
   —Å–∫—Ä–∏–ø—Ç —É package.json:
   "scripts": {
   "dev": "nodemon src/index.js"
   };
   –∑–∞–ø—É—Å–∫–∞—î –¥–æ–¥–∞—Ç–æ–∫ –∫–æ–º–∞–Ω–¥–æ—é npm run dev
9. –ø–∞–ø–∫–∞ src ->

   - index.js
   - —Ñ–∞–π–ª server.js //–ª–æ–≥—ñ–∫–∞ —Ä–æ–±–æ—Ç–∏ express-—Å–µ—Ä–≤–µ—Ä—É;

<!-- ----- -->

10. npm install express (**Express** - –æ–±—Ä–æ–±–∫–∞ –∑–∞–ø–∏—Ç—ñ–≤, —Ä–æ—É—Ç—ñ–Ω–≥(–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –º–∞—Ä—à—Ä—É—Ç—ñ–≤), middleware, —Å–µ—Ä–≤—ñ—Å–∏ —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤, ...):
    import express from 'express';
    const app = express(); //–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è Express-–¥–æ–¥–∞—Ç–æ–∫ (—Å–µ—Ä–≤–µ—Ä);
    10.1. –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ - –º–µ—Ç–æ–¥ —Å–µ—Ä–≤–µ—Ä–∞ listen
11. **middleware** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –∑–∞–ø–∏—Ç—ñ–≤ –±–µ–∑ –º–∞—Ä—à—Ä—É—Ç—É, –ø–æ–º–∏–ª–∫–∏). –º–µ—Ç–æ–¥ use
    app.use(paths, middleware) //—à–ª—è—Ö, middleware
12. middleware –∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ **pino** - –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏ –ª–æ–≥–≥–µ—Ä —á–µ—Ä–µ–∑ –æ–±‚Äô—î–∫—Ç –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π.
    npm install pino-http //–ª–æ–≥–µ—Ä
    npm i --save-dev pino-pretty //—Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—ñ–≤, –≤ '–∑—Ä–æ–∑—É–º—ñ–ª–æ–º—É' –≤–∏–≥–ª—è–¥—ñ

    import pino from 'pino-http'; //–ª–æ–≥—É–≤–∞–Ω–Ω—è

    <!-- CORS -->

13. **CORS** - —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –±–µ–∑–ø–µ–∫–∏ –¥–ª—è –≤–µ–±-–¥–æ–¥–∞—Ç–∫—ñ–≤. –ù–∞–ª–∞—à—Ç–æ–≤—É—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏, —è–∫—ñ –≤–∫–∞–∑—É—é—Ç—å, —è–∫–∏–º –¥–∂–µ—Ä–µ–ª–∞–º –¥–æ–∑–≤–æ–ª–µ–Ω–æ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø.
    npm i cors // –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –ø–∞–∫–µ—Ç cors
    import cors from 'cors';
    app.use(cors());

    <!-- –ó–º—ñ–Ω–Ω—ñ –æ—Ç—á–µ–Ω–Ω—è -->

14. –ó–º—ñ–Ω–Ω—ñ –æ—Ç—á–µ–Ω–Ω—è **.env** - –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤, —Å—Ö–æ–≤–∞–Ω–∏—Ö –∫–ª—é—á—ñ–≤, —à–ª—è—Ö—ñ–≤ –¥–æ —Ñ–∞–π–ª—ñ–≤, –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å —Å–µ—Ä–≤–µ—Ä—ñ–≤ —Ç–∞ —ñ–Ω—à–æ—ó –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.
    !!!! .env –æ–¥—Ä–∞–∑—É –¥–æ–¥–∞–Ω–∏–π –≤ .gitignore
    13.1. .env.example - –º—ñ—Å—Ç–∏—Ç—å –≤—Å—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –Ω–∞–∑–≤–∏ –∑–º—ñ–Ω–Ω–∏—Ö –æ—Ç–æ—á–µ–Ω–Ω—è –±–µ–∑ —Ä–µ–∞–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å
15. npm install dotenv - –∑—á–∏—Ç—É–≤–∞—Ç–∏ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è –≤ –¥–æ–¥–∞—Ç–∫—É;
    import 'dotenv/config'; –∞–±–æ import dotenv from "dotenv"; ???
    dotenv.config();

    15.1. –î–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –∑–º—ñ–Ω–Ω–∏—Ö –æ—Ç–æ—á–µ–Ω–Ω—è –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ Node.js –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≥–ª–æ–±–∞–ª—å–Ω–∏–π –æ–±'—î–∫—Ç **process.env**

16. –ø—Ä–∏ –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ –∑–º—ñ–Ω–Ω–æ—ó –æ—Ç–æ—á–µ–Ω–Ω—è, —Å—Ç–≤–æ—Ä–∏—Ç–∏ —É—Ç–∏–ª—ñ—Ç–∞—Ä–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é —è–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏–º–µ —ó—ó –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —ñ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏–º–µ –ø–æ–º–∏–ª–∫—É, —è–∫—â–æ –∑–º—ñ–Ω–Ω–∞ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞:
    src/utils/getEnvVar.js:
    import dotenv from 'dotenv';
    dotenv.config();
    export function getEnvVar(name, defaultValue) {}

    <!-- MongoDB -->

17. –≤ .env, .env.example –æ—Ñ–æ—Ä–º–∏—Ç–∏ connection string

18. **Mongoose** ‚Äî —Ü–µ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ MongoDB —É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ Node.js.
    –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö –¥–ª—è MongoDB:

        npm install mongoose
        // src/db/initMongoDB.js
        import mongoose from 'mongoose';

19. c—Ç–≤–æ—Ä–∏–ª–∏ –∫–ª–∞—Å—Ç–µ—Ä –≤ **MongoDB Atlas**:
    - NetworkAcces;
    - Database Access - –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —è–∫–∏–π –º–∞—î –¥–æ—Å—Ç—É–ø;
    - Clusters -> Connect -> Compass (Copy the connection string ). –≤—Å—Ç–∞–≤–ª—è—î–º–æ –≤ MongoDb Compass
20. //–≤—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ **MongoDB Compass**
    –Ü–º–ø–æ—Ä—Ç –¥–∞–Ω–∏—Ö –≤ MongoDB.
    Mongo Compass - –≥—Ä–∞—Ñ—ñ—á–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ MongoDB (–≤–∑–∞—î–º–æ–¥—ñ—è –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö);
    - Connections + -> –≤—Å—Ç–∞–≤–ª—è—î–º–æ –≤ URI (–∑ –ø–∞—Ä–æ–ª–µ–º)
    - Authenion -> –ø–∞—Ä–æ–ª—å
    - Save & Conect
21. MongoDB Compass —Å—Ç–≤–æ—Ä—é—î–º–æ –±–∞–∑—É –¥–∞–Ω–∏—Ö;
    - Cluster + -> Database Name, Collection Name
    - Add Data -> import JSON
22. Shema - –¥–ª—è –¥–∞–Ω–∏—Ö –∑ –±–µ–∫–∞–Ω–¥—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ Shema
23. –≤—Å–µ —â–æ —Å—Ç–æ—Å—É—î—Ç—å—Å—è —Å–µ—Ä–≤–µ—Ä—É –≤–∏–Ω–æ—Å–∏–º–æ –≤ –æ–∫—Ä–µ–º—É –ø–∞–ø–∫—É

<!-- –§–∞–π–ª–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É -->

- –§–∞–π–ª–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É:
  - ‚úÖ constants - –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞—à–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É
  - ‚úÖ ‚úÖ controllers - –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∏
  - ‚úÖ db - —É—Å–µ, —â–æ –ø–æ–≤ º—è–∑–∞–Ω–µ —ñ–∑ –±–∞–∑–æ—é
  - ‚úÖ ‚úÖ middlewares - –∫–∞—Å—Ç–æ–º–Ω—ñ –º—ñ–¥–ª–≤–∞—Ä–∏
  - ‚úÖ ‚úÖ routers - express-—Ä–æ—É—Ç–µ—Ä–∏, —è–∫—ñ –±—É–¥—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –≤ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É
  - ‚úÖ services - –æ—Å–Ω–æ–≤–Ω–µ –º—ñ—Å—Ü–µ, –¥–µ –º–∏ –±—É–¥–µ–º–æ –ø—Ä–æ–ø–∏—Å—É–≤–∞—Ç–∏ –ª–æ–≥—ñ–∫—É
  - templates - —à–∞–±–ª–æ–Ω–∏ –¥–ª—è email
  - ‚úÖ utils - —Ä—ñ–∑–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –¥–æ–ø–æ–º–∞–≥–∞—Ç–∏–º—É—Ç—å –Ω–∞–º —Ä–æ–±–∏—Ç–∏ –ø–µ–≤–Ω—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —á–∏ –º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—ó
  - validation - –≤–∞–ª—ñ–¥–∞—Ü—ñ–π–Ω—ñ —Å—Ö–µ–º–∏
  - ‚úÖ index.js - —Ñ–∞–π–ª, –∑ —è–∫–æ–≥–æ –±—É–¥–µ –ø–æ—á–∏–Ω–∞—Ç–∏—Å—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞—à–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏
  - ‚úÖ server.js - —Ñ–∞–π–ª, –¥–µ –º–∏ –æ–ø–∏—à–µ–º–æ –Ω–∞—à express-—Å–µ—Ä–≤–µ—Ä

‚úÖ - —Å—Ç–≤–æ—Ä–µ–Ω–æ —É 2 –º–æ–¥—É–ª—ñ
‚úÖ ‚úÖ - —Å—Ç–≤–æ—Ä–µ–Ω–æ —É 3 –º–æ–¥—É–ª—ñ

<!-- POST -->

routers/contact - controllers/contact - services/contact -
